<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HBV model • hydromad</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="HBV model">
<meta property="og:description" content="hydromad">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hydromad</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-27</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/hydromad.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial.html">Tutorial</a>
    </li>
    <li>
      <a href="../articles/hbv.html">HBV model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Releases</li>
    <li>
      <a href="http://github.com/josephguillaume/hydromad" class="external-link">hydromad 0.9-27</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/josephguillaume/hydromad/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="hbv_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>HBV model</h1>
                        <h4 data-toc-skip class="author">Alexander Buzacott</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/josephguillaume/hydromad/blob/HEAD/vignettes/hbv.Rmd" class="external-link"><code>vignettes/hbv.Rmd</code></a></small>
      <div class="hidden name"><code>hbv.Rmd</code></div>

    </div>

    
    
<p>The HBV model included in <code>hydromad</code> implements the basic structure of the HBV-light by Seibert and Vis (2012). This tutorial will demonstrate how to use the <code>hydromad</code> HBV model and compare the output to the HBV-light model (v4.0.0.20, obtained from <a href="https://www.geo.uzh.ch/en/units/h2k/Services/HBV-Model.html" class="external-link uri">https://www.geo.uzh.ch/en/units/h2k/Services/HBV-Model.html</a>).</p>
<div class="section level2">
<h2 id="data-requirements">Data requirements<a class="anchor" aria-label="anchor" href="#data-requirements"></a>
</h2>
<p>Most of the required data for the model are similar to standard hydromad:</p>
<ul>
<li>P: timeseries of precipitation (mm)</li>
<li>Q: timeseries of observed discharge (mm)</li>
<li>E: timeseries of potential evapotranspiration (PET) Specifically for HBV, a further column needs to be added with:</li>
<li>T: timeseries of average temperature (ºC)</li>
</ul>
<p>If daily estimates of potential evapotranspiration are not available for your catchment, then they can be calculated using the HBV method (see equation 7 Seibert and Vis, 2012).</p>
<ul>
<li>A vector of length 365 with daily average PET for each day of the year</li>
<li>A vector of length 12 with average daily PET for each month of the year</li>
</ul>
<p>A vector of length 12 or 365 of mean temperature can also be provided for use in calculating PET. If it is not provided then mean monthly temperature is calculated from the timeseries of temperature. A demonstration of using the HBV PET method is provided later.</p>
</div>
<div class="section level2">
<h2 id="model-parameters">Model parameters<a class="anchor" aria-label="anchor" href="#model-parameters"></a>
</h2>
<p>The structure of the model in <code>hydromad</code> replicates the HBV-light standard version using UZL and K0 in SUZ-box.</p>
<div class="section level3">
<h3 id="snow-routine">Snow routine<a class="anchor" aria-label="anchor" href="#snow-routine"></a>
</h3>
<ul>
<li>
<code>tt</code> Threshold temperature for snow and snow melt in degrees Celsius.</li>
<li>
<code>cfmax</code> Degree-day factor for snow melt (mm/(ºC.day)).</li>
<li>
<code>sfcf</code> Snowfall correction factor. Amount of precipitation below threshold temperature that should be rainfall instead of snow.</li>
<li>
<code>cfr</code> Refreezing coefficient for water in the snowpack.</li>
<li>
<code>cwh</code> Liquid water holding capacity of the snowpack.</li>
</ul>
</div>
<div class="section level3">
<h3 id="soil-routine">Soil routine<a class="anchor" aria-label="anchor" href="#soil-routine"></a>
</h3>
<ul>
<li>
<code>fc</code> Maximum amount of soil moisture storage (mm).</li>
<li>
<code>lp</code> Threshold for reduction of evaporation. Limit for potential evapotranspiration.</li>
<li>
<code>beta</code> Shape coefficient in soil routine.</li>
<li>
<code>cet</code> Potential ET correction factor. Not required if PET is provided for all timesteps</li>
</ul>
<p>In addition there is an optional flag <code>initialise_sm</code> to set the soil moisture store to equal <code>fc</code>*<code>lp</code> at the first timestep to match HBV-light behaviour. The default is false to match other <code>hydromad</code> models.</p>
</div>
<div class="section level3">
<h3 id="routing-routine">Routing routine<a class="anchor" aria-label="anchor" href="#routing-routine"></a>
</h3>
<ul>
<li>
<code>perc</code> Maximum percolation from upper to lower groundwater storage.</li>
<li>
<code>uzl</code> Threshold for quick runoff for k0 outflow (mm).</li>
<li>
<code>k0</code> Recession coefficient (quick runoff).</li>
<li>
<code>k1</code> Recession coefficient (upper groundwater storage).</li>
<li>
<code>k2</code> Recession coefficient (lower groundwater storage).</li>
<li>
<code>maxbas</code> Routing, length of triangular weighting function (days).</li>
</ul>
<p>An additional model setting <code>initial_slz</code> can be used to set the initial value for the lower groundwater store (SLZ). This appears to equal the first streamflow timestep value divided by the <code>k2</code> parameter in HBV-light but can be set to any value.</p>
</div>
</div>
<div class="section level2">
<h2 id="state-variables">State variables<a class="anchor" aria-label="anchor" href="#state-variables"></a>
</h2>
<p>The following state variables can be returned from the model:</p>
<ul>
<li>Soil moisture accounting (<code>sma="hbv"</code>) module
<ul>
<li>
<code>Snow</code> snow depth (mm)</li>
<li>
<code>SM</code> soil moisture (mm)</li>
<li>
<code>PET</code> potential evapotranspiration (mm)</li>
<li>
<code>AET</code> actual evapotranspiration (mm)</li>
<li>
<code>U</code> effective precipitation, or recharge, that goes to the routing module</li>
</ul>
</li>
<li>Routing (<code>routing="hbvrouting"</code>) module
<ul>
<li>
<code>SUZ</code> upper groundwater storage (mm)</li>
<li>
<code>SLZ</code> lower groundwater storage (mm)</li>
<li>
<code>Q0</code> quick runoff (mm)</li>
<li>
<code>Q1</code> runoff from the upper groundwater store (mm)</li>
<li>
<code>Q2</code> runoff from the lower groundwater store (mm)</li>
<li>
<code>X</code> routed streamflow (mm)</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This example uses the example dataset from the Corin Catchment, ACT, Australia which is included with <code>hydromad</code>. This dataset is a <code>zoo</code> object that contains daily estimates of all the required variables.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Corin</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Corin</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##               P      Q    E    T</span>
<span class="co">## 2016-01-01 0.00 0.1152 7.87 21.4</span>
<span class="co">## 2016-01-02 0.00 0.1170 4.50 17.9</span>
<span class="co">## 2016-01-03 3.90 0.1264 3.97 16.1</span>
<span class="co">## 2016-01-04 6.33 0.1799 2.64 13.7</span>
<span class="co">## 2016-01-05 9.48 0.3879 2.41 13.7</span>
<span class="co">## 2016-01-06 0.00 0.3033 3.37 14.3</span></code></pre>
<p>Set up and fit model. If the parameters or parameter ranges are not specified then the default ranges for <code>hbv</code> and <code>hbvrouting</code> are used. These can be viewed using <code><a href="../reference/hbv.html">hbv.ranges()</a></code> and <code><a href="../reference/hbv.html">hbvrouting.ranges()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hydromad.html">hydromad</a></span><span class="op">(</span>DATA <span class="op">=</span> <span class="va">Corin</span>,
                sma <span class="op">=</span> <span class="st">"hbv"</span>,
                routing <span class="op">=</span> <span class="st">"hbvrouting"</span><span class="op">)</span>
<span class="co"># Calibrate the default parameter ranges</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitByOptim.html">fitByOptim</a></span><span class="op">(</span><span class="va">mod</span>, method <span class="op">=</span> <span class="st">"PORT"</span><span class="op">)</span></code></pre></div>
<p>A summary of the model fit and plot of the simulated and modelled streamflow series can be obtained as follows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## hydromad(DATA = Corin, sma = "hbv", routing = "hbvrouting", perc = 0.798432, </span>
<span class="co">##     uzl = 15.4616, k0 = 0.100156, k1 = 0.125015, k2 = 0.040413, </span>
<span class="co">##     maxbas = 1.50607, tt = 0.328283, cfmax = 2.27273, sfcf = 0.430303, </span>
<span class="co">##     cfr = 0.0191919, cwh = 0.187879, fc = 312.218, lp = 0.898577, </span>
<span class="co">##     beta = 2.69746)</span>
<span class="co">## </span>
<span class="co">## Time steps: 1361 (0 missing).</span>
<span class="co">## Runoff ratio (Q/P): (0.4495 / 2.315) = 0.1942</span>
<span class="co">## rel bias: -0.02689</span>
<span class="co">## r squared: 0.9157</span>
<span class="co">## r sq sqrt: 0.9157</span>
<span class="co">## r sq log: 0.8606</span>
<span class="co">## </span>
<span class="co">## For definitions see ?hydromad.stats</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<p><img src="hbv_files/figure-html/modplot-1.png" width="576" style="display: block; margin: auto;"></p>
<p>To calculate PET using the method (Seibert and Vis, 2012; equation 7), a list with named objects <code>"PET"</code> and <code>"Tmean"</code> need to be supplied to the <code>PET</code> argument when setting up the model. In addition, the <code>cet</code> parameter needs to be provided. Either a single value or a range can be provided if <code>cet</code> is to be calibrated.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hydromad.html">hydromad</a></span><span class="op">(</span>DATA <span class="op">=</span> <span class="va">Corin</span>,
                sma <span class="op">=</span> <span class="st">"hbv"</span>,
                routing <span class="op">=</span> <span class="st">"hbvrouting"</span>,
                PET <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"PET"</span> <span class="op">=</span> <span class="va">corin_pet</span>,
                           <span class="st">"Tmean"</span> <span class="op">=</span> <span class="va">corin_tmean</span><span class="op">)</span>,
                cet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/zC.html" class="external-link">C</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="comparison-to-hbv-light">Comparison to HBV-light<a class="anchor" aria-label="anchor" href="#comparison-to-hbv-light"></a>
</h1>
<p>Here are some comparisons to output of the HBV-light model to ensure that correct model structures have been implemented. Comparisons are made using the Corin catchment dataset and the HBV-land dataset that comes with the HBV-light model. No warmup periods are used here to show the models produce the same results, but typically warm up periods range from 100 days (<code>hydromad</code> default) to a year.</p>
<div class="section level2">
<h2 id="corin-catchment">Corin catchment<a class="anchor" aria-label="anchor" href="#corin-catchment"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hydromad.html">hydromad</a></span><span class="op">(</span>DATA <span class="op">=</span> <span class="va">Corin</span>,
                sma <span class="op">=</span> <span class="st">"hbv"</span>,
                routing <span class="op">=</span> <span class="st">"hbvrouting"</span>,
                tt <span class="op">=</span> <span class="fl">0</span>, <span class="co"># Snow</span>
                cfmax <span class="op">=</span> <span class="fl">6.36</span>,
                sfcf <span class="op">=</span> <span class="fl">1</span>, 
                cfr <span class="op">=</span> <span class="fl">0.05</span>,
                cwh <span class="op">=</span> <span class="fl">0.19</span>,
                fc <span class="op">=</span> <span class="fl">317</span>, <span class="co"># Soil</span>
                lp <span class="op">=</span> <span class="fl">0.89</span>, 
                beta <span class="op">=</span> <span class="fl">2.68</span>,
                perc <span class="op">=</span> <span class="fl">0.89</span>, <span class="co"># Routing</span>
                uzl <span class="op">=</span> <span class="fl">71.34</span>,
                k0 <span class="op">=</span> <span class="fl">0.11</span>,
                k1 <span class="op">=</span> <span class="fl">0.15</span>,
                k2 <span class="op">=</span> <span class="fl">0.04</span>, 
                maxbas <span class="op">=</span> <span class="fl">1.5</span>,
                return_state <span class="op">=</span> <span class="cn">TRUE</span>,
                return_components <span class="op">=</span> <span class="cn">TRUE</span>,
                initialise_sm <span class="op">=</span> <span class="cn">TRUE</span>,
                initial_slz <span class="op">=</span> <span class="va">Corin</span><span class="op">$</span><span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fl">0.04</span>, <span class="co"># first Q timestep / k2</span>
                warmup <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>The models produce the same results:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">value</span>, col<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Value (mm)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales<span class="op">=</span><span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="hbv_files/figure-html/comparison-1.png" width="672"></p>
<p>Only small rounding differences exist.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">diff</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Value (mm)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="hbv_files/figure-html/differences-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="hbv-land">HBV-land<a class="anchor" aria-label="anchor" href="#hbv-land"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hydromad.html">hydromad</a></span><span class="op">(</span>DATA <span class="op">=</span> <span class="va">hbv_land</span>,
                sma <span class="op">=</span> <span class="st">"hbv"</span>,
                routing <span class="op">=</span> <span class="st">"hbvrouting"</span>,
                tt <span class="op">=</span> <span class="op">-</span><span class="fl">1.76</span>, <span class="co"># Snow</span>
                cfmax <span class="op">=</span> <span class="fl">2.98</span>,
                sfcf <span class="op">=</span> <span class="fl">0.73</span>, 
                cfr <span class="op">=</span> <span class="fl">0.05</span>,
                cwh <span class="op">=</span> <span class="fl">0.1</span>,
                fc <span class="op">=</span> <span class="fl">285</span>, <span class="co"># Soil</span>
                lp <span class="op">=</span> <span class="fl">0.75</span>, 
                beta <span class="op">=</span> <span class="fl">3.43</span>,
                cet <span class="op">=</span> <span class="fl">0.1</span>,
                perc <span class="op">=</span> <span class="fl">1.02</span>, <span class="co"># Routing</span>
                uzl <span class="op">=</span> <span class="fl">17.6</span>,
                k0 <span class="op">=</span> <span class="fl">0.25</span>,
                k1 <span class="op">=</span> <span class="fl">0.09</span>,
                k2 <span class="op">=</span> <span class="fl">0.06</span>, 
                maxbas <span class="op">=</span> <span class="fl">2.4</span>,
                return_state <span class="op">=</span> <span class="cn">TRUE</span>,
                return_components <span class="op">=</span> <span class="cn">TRUE</span>,
                initialise_sm <span class="op">=</span> <span class="cn">TRUE</span>,
                initial_slz <span class="op">=</span> <span class="va">hbv_land</span><span class="op">$</span><span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fl">0.06</span>, <span class="co"># first Q timestep / k2</span>
                warmup <span class="op">=</span> <span class="fl">0</span>,
                PET <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"PET"</span><span class="op">=</span><span class="va">hbv_land_pet</span>, <span class="st">"Tmean"</span> <span class="op">=</span> <span class="va">hbv_land_tmean</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">value</span>, col<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Value (mm)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales<span class="op">=</span><span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="hbv_files/figure-html/comparison2-1.png" width="672"></p>
<p>Again there are only small rounding differences.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">diff</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Value (mm)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="hbv_files/figure-html/differences2-1.png" width="672"></p>
</div>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<p>If you use the <code>hydromad</code> HBV model, you should cite the paper by Seibert and Vis, 2012 as well as the <code>hydromad</code> package.</p>
<ul>
<li>Seibert, J. and Vis, M. (2012). Teaching hydrological modeling with a user-friendly catchment-runoff-model software package. Hydrology and Earth System Sciences, 16, 3315–3325, 2012.</li>
</ul>
<p>For additional HBV references, see:</p>
<ul>
<li>Bergström, S. and Forsman, A.: Development of a Conceptual Deterministic Rainfall-Runoff Model, Nordic Hydrology, 4(3), 147–170, 1973.</li>
<li>Bergström, S.: The HBV Model: Its Structure and Applications,Swedish Meteorological and Hydrological Institute (SMHI), Hydrology, Norrköping, 35 pp., 1992.</li>
<li>Seibert, J. (1997). Estimation of Parameter Uncertainty in the HBV Model. Hydrology Research, 28(4–5), 247–262.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joseph Guillaume.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
