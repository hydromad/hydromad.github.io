<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>IHACRES Catchment Wetness Index (CWI) model — IHACRES.CWI.model • hydromad</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="IHACRES Catchment Wetness Index (CWI) model — IHACRES.CWI.model" />
<meta property="og:description" content="The Catchment Wetness Index (CWI) effective rainfall model for
  IHACRES. This is the classic model of Jakeman and Hornberger (1993),
  with the extensions to ephemeral catchments of Ye et al. (1997)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hydromad</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hydromad.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">Tutorial</a>
    </li>
    <li>
      <a href="../articles/hbv.html">HBV model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Releases</li>
    <li>
      <a href="http://github.com/josephguillaume/hydromad">hydromad 0.9-27</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/josephguillaume/hydromad/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>IHACRES Catchment Wetness Index (CWI) model</h1>
    
    <div class="hidden name"><code>IHACRES.CWI.model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Catchment Wetness Index (CWI) effective rainfall model for
  IHACRES. This is the classic model of Jakeman and Hornberger (1993),
  with the extensions to ephemeral catchments of Ye et al. (1997).</p>
    </div>

    <pre class="usage"><span class='fu'>cwi.sim</span><span class='op'>(</span><span class='va'>DATA</span>,
  <span class='va'>tw</span>, f <span class='op'>=</span> <span class='fl'>0</span>, <span class='va'>scale</span>,
        l <span class='op'>=</span> <span class='fl'>0</span>, p <span class='op'>=</span> <span class='fl'>1</span>,
        t_ref <span class='op'>=</span> <span class='fu'><a href='hydromad.options.html'>hydromad.getOption</a></span><span class='op'>(</span><span class='st'>"cwi"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>t_ref</span>,
        s_0 <span class='op'>=</span> <span class='fl'>0</span>,
        return_state <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>DATA</th>
      <td><p>a <code><a href='https://rdrr.io/r/stats/ts.html'>ts</a></code>-like object with named columns:</p><dl>
      <dt><code>P</code></dt><dd><p>time series of areal rainfall depths, usually in mm.</p></dd>
      <dt><code>E</code></dt><dd><p>time series of potential evapo-transpiration, or more typically,
	temperature as an indicator of this.
	Can be omitted if <code>f = 0</code>.</p></dd>
    
</dl><p></p></td>
    </tr>
    <tr>
      <th>tw</th>
      <td><p>drying rate at reference temperature (\(\tau_\omega\)).
    This is a <em>time constant</em>, the number of time steps to reduce
    to a fraction \(1/e \approx 37\%\). See definition below.</p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>temperature dependence of drying rate. See definition below.
    The case of <code>f=0</code> describes an invariant drying rate model,
    in which case the input data <code>E</code> is not required.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>mass balance term (<var>c</var> in the literature).
    If this parameter is set to <code>NA</code> (as it is by default)
    in <code><a href='hydromad.html'>hydromad</a></code> it will be set by mass balance calculation.</p></td>
    </tr>
    <tr>
      <th>l</th>
      <td><p>moisture threshold for producing flow (in units of <var>s</var>).
    This can be used together with <code>p</code> for ephemeral rivers.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>power on soil moisture (above the threshold <code>l</code>).</p></td>
    </tr>
    <tr>
      <th>t_ref</th>
      <td><p>reference temperature in units of <code>E</code> (traditionally 20 deg. C).
    This is not a parameter; it simply transforms <code>tw</code>
    (scaling <code>tw</code> by <code><a href='https://rdrr.io/r/base/Log.html'>exp(0.062 * t_ref * f)</a></code>.</p></td>
    </tr>
    <tr>
      <th>s_0</th>
      <td><p>starting value for soil moisture index <var>s</var>.</p></td>
    </tr>
    <tr>
      <th>return_state</th>
      <td><p>to return state variables as well as the effective rainfall.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The IHACRES model with an antecedent precipitation index was introduced by
  Jakeman et al. (1990), based on the Bedford-Ouse model of Whitehead
  et al. (1979). This slightly more physics-based version with a
  Catchment Wetness Index (CWI) was developed by Jakeman and Hornberger
  (1993). It is a metric-type model, where rainfall effectiveness is
  proportional to a simple antecedent moisture index, and the output is
  scaled to enforce mass balance.</p>  
<p>The effective rainfall at each time step is proportional to
	rainfall, scaled by a soil moisture index <var>s</var>:
	$$U_t = c \cdot s_t \cdot P_t$$</p>
<p>Or, if the parameters <code>l</code> and <code>p</code> for ephemeral rivers
	are used (after Ye et al., 1997):
	$$U_t = (c (s_t - l))^p \cdot P_t$$</p>
<p>The soil moisture index <var>s</var> is calculated by a filter applied to the rainfall,
	where the drying rate is defined by a <em>time constant</em> \(\tau_{\omega,~t}\):
	$$s_t = (1 - 1 / \tau_{\omega,t}) s_{t-1} + P_t$$</p>
<p>If <code>f = 0</code> then the drying time constant is equal to the value of <code>tw</code>.
	Otherwise the drying rate varies over time according to the input data <code>E</code>:
	$$\tau_{\omega,t} = \tau_\omega \exp(-0.062 f E_t)$$</p>
<p>Note that the drying rate and effective rainfall are bounded below by 0,
	a step omitted in the equations above.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>cwi.sim</code> returns the modelled time series of effective rainfall,
  or if <code>return_state = TRUE</code>, a multi-variate time series with named
  columns <code>U</code> (effective rainfall), <code>s</code> (index of soil
  moisture, <var>s</var>) and <code>w</code> (the recession rate of <var>s</var>, i.e.
  \((1 - 1 / \tau_{\omega,t})\).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jakeman, A. J., and G. M. Hornberger (1993),
  How much complexity is warranted in a rainfall-runoff model?,
  <em>Water Resources Research</em>, 29: 2637-2649.</p>
<p>Jakeman, A.J., I.G. Littlewood, and P.G. Whitehead (1990),
  Computation of the instantaneous unit hydrograph and identifiable component flows
  with application to two small upland catchments,
  <em>Journal of Hydrology</em>, 117: 275-300.</p>
<p>Ye, W., B.C. Bates, N.R. Viney, M. Sivapalan and A.J. Jakeman (1997),
  Performance of conceptual rainfall-runoff models in low-yielding ephemeral catchments,
  <em>Water Resources Research</em>, 33: 153-16.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Felix Andrews <a href='mailto:felix@nfrac.org'>felix@nfrac.org</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='hydromad.html'>hydromad</a>(sma = "cwi")</code> to work with models as objects (recommended).</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## view default parameter ranges:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'><a href='hydromad.options.html'>hydromad.options</a></span><span class='op'>(</span><span class='st'>"cwi"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; List of 1
#&gt;  $ cwi:List of 6
#&gt;   ..$ tw   : num [1:2] 0 100
#&gt;   ..$ f    : num [1:2] 0 8
#&gt;   ..$ scale: num NA
#&gt;   ..$ l    : num 0
#&gt;   ..$ p    : num 1
#&gt;   ..$ t_ref: num 20</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Canning</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>cwi.sim</span><span class='op'>(</span><span class='va'>Canning</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>1000</span>,<span class='op'>]</span>, tw <span class='op'>=</span> <span class='fl'>162</span>, f <span class='op'>=</span> <span class='fl'>2</span>, l <span class='op'>=</span> <span class='fl'>300</span>,
             t_ref <span class='op'>=</span> <span class='fl'>0</span>, scale <span class='op'>=</span> <span class='fl'>0.000284</span>, return_state <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>xyplot</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='img'><img src='IHACRES.CWI.model-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>HydroTestData</span><span class='op'>)</span>
<span class='va'>mod0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='hydromad.html'>hydromad</a></span><span class='op'>(</span><span class='va'>HydroTestData</span>, sma <span class='op'>=</span> <span class='st'>"cwi"</span>, routing <span class='op'>=</span> <span class='st'>"expuh"</span><span class='op'>)</span>
<span class='va'>mod0</span>
</div><div class='output co'>#&gt; 
#&gt; Hydromad model with "cwi" SMA and "expuh" routing:
#&gt; Start = 2000-01-01, End = 2000-03-31
#&gt; 
#&gt; SMA Parameters:
#&gt;       lower upper     
#&gt; tw        0   100     
#&gt; f         0     8     
#&gt; scale    NA    NA     
#&gt; l         0     0 (==)
#&gt; p         1     1 (==)
#&gt; t_ref    20    20 (==)
#&gt; Routing Parameters:
#&gt; NULL</div><div class='input'>
<span class='co'>## simulate with some arbitrary parameter values</span>
<span class='va'>mod1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>mod0</span>, tw <span class='op'>=</span> <span class='fl'>32</span>, f <span class='op'>=</span> <span class='fl'>2</span>, scale <span class='op'>=</span> <span class='fl'>0.01</span>, tau_s <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>

<span class='co'>## plot results with state variables</span>
<span class='va'>testQ</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>mod1</span>, return_state <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>xyplot</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>HydroTestData</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, cwi <span class='op'>=</span> <span class='va'>testQ</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='IHACRES.CWI.model-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## show effect of increase/decrease in each parameter</span>
<span class='va'>parRanges</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>tw <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span><span class='op'>)</span>, f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>parsims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span>val <span class='op'>=</span> <span class='va'>parRanges</span>, nm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>parRanges</span><span class='op'>)</span>,
  FUN <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>val</span>, <span class='va'>nm</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>lopar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>val</span><span class='op'>)</span>
    <span class='va'>hipar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>val</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>lopar</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>hipar</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>nm</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='fu'><a href='runlist.html'>runlist</a></span><span class='op'>(</span>decrease <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>mod1</span>, newpars <span class='op'>=</span> <span class='va'>lopar</span><span class='op'>)</span>,
                   increase <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>mod1</span>, newpars <span class='op'>=</span> <span class='va'>hipar</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>, SIMPLIFY <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='fu'>xyplot.list</span><span class='op'>(</span><span class='va'>parsims</span>, superpose <span class='op'>=</span> <span class='cn'>TRUE</span>, layout <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='cn'>NA</span><span class='op'>)</span>,
            main <span class='op'>=</span> <span class='st'>"Simple parameter perturbation example"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>latticeExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/latticeExtra/man/layer.html'>layer</a></span><span class='op'>(</span><span class='fu'>panel.lines</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>mod1</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"grey"</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='IHACRES.CWI.model-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joseph Guillaume.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


