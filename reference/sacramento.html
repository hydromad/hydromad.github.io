<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sacramento Soil Moisture Accounting model — sacramento • hydromad</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Sacramento Soil Moisture Accounting model — sacramento"><meta property="og:description" content="Sacramento Soil Moisture Accounting model.  Developed by the US National
Weather Service."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hydromad</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-27</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/hydromad.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Tutorial</a>
    </li>
    <li>
      <a href="../articles/hbv.html">HBV model</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Releases</li>
    <li>
      <a href="http://github.com/josephguillaume/hydromad" class="external-link">hydromad 0.9-27</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/josephguillaume/hydromad/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sacramento Soil Moisture Accounting model</h1>
    <small class="dont-index">Source: <a href="https://github.com/josephguillaume/hydromad/blob/HEAD/R/sacramento.R" class="external-link"><code>R/sacramento.R</code></a></small>
    <div class="hidden name"><code>sacramento.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sacramento Soil Moisture Accounting model.  Developed by the US National
Weather Service.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">sacramento.sim</span><span class="op">(</span>
  <span class="va">DATA</span>,
  <span class="va">uztwm</span>,
  <span class="va">uzfwm</span>,
  <span class="va">uzk</span>,
  <span class="va">pctim</span>,
  <span class="va">adimp</span>,
  <span class="va">zperc</span>,
  <span class="va">rexp</span>,
  <span class="va">lztwm</span>,
  <span class="va">lzfsm</span>,
  <span class="va">lzfpm</span>,
  <span class="va">lzsk</span>,
  <span class="va">lzpk</span>,
  <span class="va">pfree</span>,
  etmult <span class="op">=</span> <span class="fl">1</span>,
  dt <span class="op">=</span> <span class="fl">1</span>,
  uztwc_0 <span class="op">=</span> <span class="fl">0.5</span>,
  uzfwc_0 <span class="op">=</span> <span class="fl">0.5</span>,
  lztwc_0 <span class="op">=</span> <span class="fl">0.5</span>,
  lzfsc_0 <span class="op">=</span> <span class="fl">0.5</span>,
  lzfpc_0 <span class="op">=</span> <span class="fl">0.5</span>,
  adimc_0 <span class="op">=</span> <span class="fl">0.5</span>,
  min_ninc <span class="op">=</span> <span class="fl">20</span>,
  return_state <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>DATA</dt>
<dd><p>time-series-like object with columns <code>P</code> (precipitation,
mm) and <code>E</code> (potential evapo-transpiration, mm, scaled by
<code>etmult</code>).</p></dd>
<dt>uztwm</dt>
<dd><p>Upper zone tension water maximum capacity (mm).</p></dd>
<dt>uzfwm</dt>
<dd><p>Upper zone free water maximum capacity (mm).</p></dd>
<dt>uzk</dt>
<dd><p>Lateral drainage rate of upper zone free water expressed as a
fraction of contents per day.</p></dd>
<dt>pctim</dt>
<dd><p>The fraction of the catchment which produces impervious runoff
during low flow conditions.</p></dd>
<dt>adimp</dt>
<dd><p>The additional fraction of the catchment which exhibits
impervious characteristics when the catchment's tension water requirements
are met.</p></dd>
<dt>zperc</dt>
<dd><p>Maximum percolation (from upper zone free water into the lower
zone) rate coefficient.</p></dd>
<dt>rexp</dt>
<dd><p>An exponent determining the rate of change of the percolation
rate with changing lower zone water contents.</p></dd>
<dt>lztwm</dt>
<dd><p>Lower zone tension water maximum capacity (mm).</p></dd>
<dt>lzfsm</dt>
<dd><p>Lower zone supplemental free water maximum capacity (mm).</p></dd>
<dt>lzfpm</dt>
<dd><p>Lower zone primary free water maximum capacity (mm).</p></dd>
<dt>lzsk</dt>
<dd><p>Lateral drainage rate of lower zone supplemental free water
expressed as a fraction of contents per day.</p></dd>
<dt>lzpk</dt>
<dd><p>Lateral drainage rate of lower zone primary free water expressed
as a fraction of contents per day.</p></dd>
<dt>pfree</dt>
<dd><p>Direct percolation fraction from upper to lower zone free water
(the percentage of percolated water which is available to the lower zone
free water aquifers before all lower zone tension water deficiencies are
satisfied).</p></dd>
<dt>etmult</dt>
<dd><p>Multiplier applied to <code>DATA$E</code> to estimate potential
evapotranspiration.</p></dd>
<dt>dt</dt>
<dd><p>Length of each time step in days.</p></dd>
<dt>uztwc_0</dt>
<dd><p>Initial upper zone tension water contents as proportion of
<code>uztwm</code></p></dd>
<dt>uzfwc_0</dt>
<dd><p>Initial upper zone free water content as proportion of
<code>uzfwm</code></p></dd>
<dt>lztwc_0</dt>
<dd><p>Initial lower zone tension water content as proportion of
<code>lztwm</code></p></dd>
<dt>lzfsc_0</dt>
<dd><p>Initial lower zone free water secondary as proportion of
<code>lzfsm</code></p></dd>
<dt>lzfpc_0</dt>
<dd><p>Initial lower zone free water primary as proportion of
<code>lzfpm</code></p></dd>
<dt>adimc_0</dt>
<dd><p>Initial additional impervious flow store, as proportion of
<code>uztwm+lztwm</code></p></dd>
<dt>min_ninc</dt>
<dd><p>Minimum number of inner iterations. This is a simple attempt
to improve numerical stability. See Details.</p></dd>
<dt>return_state</dt>
<dd><p>to return time series of each state variable and flow
component</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>the simulated effective rainfall (“total channel inflow”), a
time series of the same length as the input series.
if <code>return_state=TRUE</code>, a list with components:</p>
<dl><dt>uztwc</dt>
<dd><p>Upper zone
tension water content</p></dd>
<dt>uzfwc</dt>
<dd><p>Upper zone free water content</p></dd>
<dt>lztwc</dt>
<dd><p>Lower zone tension water content</p></dd>
<dt>lzfsc</dt>
<dd><p>Lower zone free
secondary water content</p></dd>
<dt>lzfpc</dt>
<dd><p>Lower zone free primary water content</p></dd>
<dt>adimc</dt>
<dd><p>Tension water contents of the additional impervious area</p></dd>
<dt>sett</dt>
<dd><p>Cumulative total evapotranspiration</p></dd>
<dt>se1</dt>
<dd><p>Cumulative
evapotranspiration from upper zone tension water</p></dd>
<dt>se3</dt>
<dd><p>Cumulative
evapotranspiration from lower zone tension water</p></dd>
<dt>se4</dt>
<dd><p>Cumulative
evapotranspiration</p></dd>
<dt>se5</dt>
<dd><p>Cumulative evapotranspiration from riparian
zone</p></dd>
<dt>roimp</dt>
<dd><p>Runoff from impervious area</p></dd>
<dt>sdro</dt>
<dd><p>Six hour sum of
runoff (?)</p></dd>
<dt>ssur</dt>
<dd><p>Surface runoff</p></dd>
<dt>sif</dt>
<dd><p>Interflow</p></dd>
<dt>bfp</dt>
<dd><p>Primary baseflow</p></dd>
<dt>bfs</dt>
<dd><p>Secondary baseflow</p></dd>
<dt>bfcc</dt>
<dd><p>Channel baseflow (bfp+bfs)</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This description of the model is given by Burnash (1995):</p>
<p>“The moisture accounting system utilized in the Sacramento Catchment
Model is a carefully structured representation of the catchment's soil
moisture storage system. It is based on using simple approximations of many
of those soil moisture processes which have been reported in the hydrologic
literature. The authors have organised these approximations in a manner
which would allow the determination of many catchment characteristics from
carefully selected portions of the catchment's hydrologic record. Inasmuch
as many of the catchment characteristics are related to the soil moisture
capabilities of the catchment, an intelligent application of the model start
with a good understanding of the three basic types of soil moisture which
can potentially influence catchment runoff conditions. These soil moisture
types are: (1) Hygroscopic Water, (2) Tension Water and (3) Free Water. ”</p>
<p>[...]</p>
<p>“Streamflow as computed by the Sacramento Catchment Model is the
result of processing precipiatation through an algorithm representing the
uppermost soil mantle identified as the upper zone and a deeper portion of
the soil mantle or lower zone. The algorithm computes runoff in five basic
forms. These are (1) direct runoff from permanant and temporary impervious
areas, (2) surface runoff due to precipitation occurring at a rate faster
than percolation and interflow can take place when both upper zone storages
are full, (3) interflow resulting from the lateral drainage of a temporary
free water storage, (4) supplemental base flow, and (5) primary base flow.”
(Burnash, 1995)</p>
<p>The default parameter ranges were taken from Blasone et. al. (2008).</p>
<p>Note that the Sacramento model potentially suffers from numerical
instabilities, which can be seen for example as discontinuities in output
and derivatives of outputs (see Hendrickson et al. 1988). Ideally, the
underlying differential equations of the model would be solved using a
numerically robust timestepping scheme (see Clark &amp; Kavetski 2010). The
hydromad package makes use of an existing implementation. To help remedy the
numerical instability, the argument <code>min_ninc</code> has been added, which
defines the minimum number of inner loops used within each timestep. The
user is encouraged to test the effect of increasing <code>min_ninc</code> on their
dataset.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Burnash, R.J.C (1995). The NWS River Forecast System --
Catchment Modeling.  In: Vijay P. Singh (ed.), <em>Computer models of
watershed hydrology.</em> Revised edition, Highlands Ranch, Colo. : Water
Resources Publications, c1995.  <a href="http://www.wrpllc.com/books/cmwh.html" class="external-link">http://www.wrpllc.com/books/cmwh.html</a>.</p>
<p>Blasone, R., J.A. Vrugt, H. Madsen, D. Rosbjerg, B.A. Robinson, G.A.
Zyvoloski (2008). Generalized likelihood uncertainty estimation (GLUE) using
adaptive Markov Chain Monte Carlo sampling. <em>Advances in Water
Resources</em> 31, pp. 630-648.</p>
<p>Hendrickson, Jene' D., Soroosh Sorooshian, and Larry E. Brazil (1988)
Comparison of Newton-Type and Direct Search Algorithms for Calibration of
Conceptual Rainfall-Runoff Models. <em>Water Resources Research</em> 24 (5):
691-700.  <a href="http://dx.doi.org/10.1029/WR024i005p00691" class="external-link">http://dx.doi.org/10.1029/WR024i005p00691</a></p>
<p>Clark, Martyn P., and Dmitri Kavetski (2010) Ancient Numerical Daemons of
Conceptual Hydrological Modeling: 1. Fidelity and Efficiency of Time
Stepping Schemes.” Water Resources Research 46 (10).
<a href="http://dx.doi.org/10.1029/2009WR008894" class="external-link">http://dx.doi.org/10.1029/2009WR008894</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="hydromad.html">hydromad</a>(sma = "sacramento")</code> to work with models as
objects (recommended).</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Felix Andrews <a href="mailto:felix@nfrac.org">felix@nfrac.org</a> and Joseph Guillaume, based
on code from the University of Arizona MOSCEM project</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## view default parameter ranges:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="hydromad.options.html">hydromad.options</a></span><span class="op">(</span><span class="st">"sacramento"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sacramento:List of 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ uztwm: num [1:2] 1 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ uzfwm: num [1:2] 1 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ uzk  : num [1:2] 0.1 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pctim: num [1:2] 1e-06 1e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ adimp: num [1:2] 0 0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ zperc: num [1:2] 1 250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ rexp : num [1:2] 0 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lztwm: num [1:2] 1 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lzfsm: num [1:2] 1 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lzfpm: num [1:2] 1 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lzsk : num [1:2] 0.01 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lzpk : num [1:2] 0.0001 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pfree: num [1:2] 0 0.6</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">HydroTestData</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod0</span> <span class="op">&lt;-</span> <span class="fu"><a href="hydromad.html">hydromad</a></span><span class="op">(</span><span class="va">HydroTestData</span>, sma <span class="op">=</span> <span class="st">"sacramento"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hydromad model with "sacramento" SMA and NULL routing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start = 2000-01-01, End = 2000-03-31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SMA Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       lower   upper  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> uztwm 1e+00  150.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> uzfwm 1e+00  150.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> uzk   1e-01    0.50  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pctim 1e-06    0.10  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adimp 0e+00    0.40  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zperc 1e+00  250.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rexp  0e+00    5.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lztwm 1e+00  500.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lzfsm 1e+00 1000.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lzfpm 1e+00 1000.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lzsk  1e-02    0.25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lzpk  1e-04    0.25  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pfree 0e+00    0.60  </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## simulate with some arbitrary parameter values</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod0</span>, etmult <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>, <span class="fl">1</span>,</span>
<span class="r-in">  sampletype <span class="op">=</span></span>
<span class="r-in">    <span class="st">"random"</span></span>
<span class="r-in"><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">testQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod1</span>, return_state <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">HydroTestData</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, sacramento <span class="op">=</span> <span class="va">testQ</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="sacramento-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="va">mod1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hydromad model with "sacramento" SMA and NULL routing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start = 2000-01-01, End = 2000-03-31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SMA Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     uztwm      uzfwm        uzk      pctim      adimp      zperc       rexp  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  28.54746  105.65373    0.32933    0.01681    0.37754  235.92526    0.64579  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lztwm      lzfsm      lzfpm       lzsk       lzpk      pfree     etmult  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 416.89100  468.55050  550.43380    0.14264    0.05980    0.45631    0.01000  </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## show effect of increase/decrease in each parameter</span></span>
<span class="r-in"><span class="va">parRanges</span> <span class="op">&lt;-</span> <span class="fu"><a href="hydromad.options.html">hydromad.getOption</a></span><span class="op">(</span><span class="st">"sacramento"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">parsims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span></span>
<span class="r-in">  val <span class="op">=</span> <span class="va">parRanges</span>, nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">parRanges</span><span class="op">)</span>,</span>
<span class="r-in">  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">val</span>, <span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="va">lopar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">hipar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lopar</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hipar</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">nm</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="fu"><a href="runlist.html">runlist</a></span><span class="op">(</span></span>
<span class="r-in">      decrease <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod1</span>, newpars <span class="op">=</span> <span class="va">lopar</span><span class="op">)</span>,</span>
<span class="r-in">      increase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod1</span>, newpars <span class="op">=</span> <span class="va">hipar</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">}</span>, SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/c.trellis.html" class="external-link">xyplot.list</a></span><span class="op">(</span><span class="va">parsims</span>,</span>
<span class="r-in">  superpose <span class="op">=</span> <span class="cn">TRUE</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span class="r-in">  strip <span class="op">=</span> <span class="cn">FALSE</span>, strip.left <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  main <span class="op">=</span> <span class="st">"Simple parameter perturbation example"</span></span>
<span class="r-in"><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu">latticeExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/llines.html" class="external-link">panel.lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"grey"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="sacramento-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joseph Guillaume.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

