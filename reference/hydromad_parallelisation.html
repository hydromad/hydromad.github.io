<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Support for parallelisation in hydromad — hydromad_parallelisation • hydromad</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Support for parallelisation in hydromad — hydromad_parallelisation"><meta property="og:description" content="Support for parallelisation in hydromad"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hydromad</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-27</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/hydromad.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Tutorial</a>
    </li>
    <li>
      <a href="../articles/hbv.html">HBV model</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Releases</li>
    <li>
      <a href="http://github.com/josephguillaume/hydromad" class="external-link">hydromad 0.9-27</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/josephguillaume/hydromad/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Support for parallelisation in hydromad</h1>
    <small class="dont-index">Source: <a href="https://github.com/josephguillaume/hydromad/blob/HEAD/R/hydromad.parallel.R" class="external-link"><code>R/hydromad.parallel.R</code></a></small>
    <div class="hidden name"><code>hydromad_parallelisation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Support for parallelisation in hydromad</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">hydromad.parallel</span><span class="op">(</span><span class="va">settings</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>settings</dt>
<dd><p>Placeholder</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Hydromad allows model runs in some functions to be parallelised. The
parallelisation methods provided for each function depend on its
characteristics and are documented below and in each function's help page.
Parallelisation is by default turned off, as it requires the user to set it
up for their particular computer and to judge whether parallelisation is
worthwhile for their particular case.</p>
<p>A number of functions in hydromad involve performing a large number of model
runs that are to some extent independent of each other. Hydromad uses a
number of R packages to allow these models runs to occur simultaneously.
This usually involves splitting the job between separate 'worker' R
sessions. However, parallelisation involves an overhead. Even on a single
computer, it takes extra time to communicate with workers to transfer
instructions and retrieve results. Parallelisation is therefore not always
worthwhile, and the best method for parallelising a particular analysis
depends on its characteristics. Do not use parallelisation if you only have
a single core, if you will run out of memory or the analysis already runs
quickly. Several settings of the parallelisation can be modified by
specifying a list of options to the function to be parallelised, with the
argument <code>parallel</code>, e.g.:</p>
<p><code>evalPars(pars,model,parallel=list(method="foreach",
packages=c("hydromad","fuse"), async=TRUE))</code></p>
<p>The available options are described below.</p>
    </div>
    <div id="method">
    <h2>Method</h2>
    


<p>The available <code>method</code> are specific
to each function that is parallelised and documented in its respective help
page. A summary of the most common methods is given here.
<code>method="clusterApply"</code> uses either the built-in <code>parallel</code>
package or the <code>snow</code> package. Setting up the cluster requires code
like:</p>
<p><code><a href="https://rdrr.io/r/base/library.html" class="external-link">library(parallel)</a></code><br><code>cl &lt;- makeCluster(2, type="SOCK")</code></p>
<p>Functions look for the object 'cl' in the global environment. The function
can be run on multiple cores on non-Windows machines by creating cl using
<code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeForkCluster</a></code>. <code>method="foreach"</code> allows a number of
backends, e.g. the packages <span class="pkg">doParallel</span>, <span class="pkg">doRedis</span>. Each of these
packages provides a backend-specific registration function that needs to be
called, e.g.:</p>
<p><code><a href="https://rdrr.io/r/base/library.html" class="external-link">library(doParallel)</a></code>
<code><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel()</a></code></p>
<p><code>foreach</code> generally incurs a higher overhead than other methods, but
has the advantage of flexibility.</p>
    </div>
    <div id="export">
    <h2>Export</h2>
    


<p>If the model being run depends on functions
or variables not defined in the hydromad package,
they may need to be explicitly exported. The names of the variables to be
exported are specified as a character vector, e.g.:</p>
<p><code>export=c("mySMA.sim","myNewObjectiveFunction")</code></p>
<p>Examples:</p><ul><li><p>if you have created your own soil moisture accounting function
<code>mySMA.sim</code></p></li>
<li><p>if your objective function or a model you have made
yourself depends on other functions or variables in the global environment,
e.g.
<code>objective=function(Q,X){myNewObjectiveFunction(Q-X)+hmadstat("r.squared")(Q,X)}</code></p></li>
</ul></div>
    <div id="packages">
    <h2>Packages</h2>
    


<p>If you are using models that defined in another
package, e.g. the <code>fuse</code> set of models, then the workers can be told to
load the package as well as hydromad by specifying, e.g.
<code>packages=c("hydromad","fuse")</code>. Make sure the package is installed on
all the workers.</p>
    </div>
    <div id="async">
    <h2>Async</h2>
    


<p>If the parallelisation method supports
it, some functions allow runs to occur in the background. Instead the
function returns immediately. Results can be retrieved later using methods
specific to the parallelisation method. Where available, this feature is
enabled with <code>async=TRUE</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Placeholder</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Functions with parallelisation: <code><a href="evalPars.html">evalPars</a></code>,
<code><a href="crossValidate.html">crossValidate</a></code>, <code>update.runlist</code>,
<code><a href="objFunVal.html">objFunVal.runlist</a></code>, <code><a href="paretoObjectivesVaryWeights.html">paretoObjectivesVaryWeights</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Joseph Guillaume</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joseph Guillaume.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

