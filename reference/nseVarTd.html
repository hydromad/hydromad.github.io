<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Time-delay corrected performance measure — nseVarTd • hydromad</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Time-delay corrected performance measure — nseVarTd" />
<meta property="og:description" content="adjVarTd coalesces modelled flow peaks to observed flow peaks for each event
separately. nseVarTd calculates Nash-Sutcliffe efficiency on the result
using nseStat.  Depending on the quality of the coalescing,
this better indicate performance ignoring timing error." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hydromad</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hydromad.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">Tutorial</a>
    </li>
    <li>
      <a href="../articles/hbv.html">HBV model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Releases</li>
    <li>
      <a href="http://github.com/josephguillaume/hydromad">hydromad 0.9-27</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/josephguillaume/hydromad/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Time-delay corrected performance measure</h1>
    <small class="dont-index">Source: <a href='https://github.com/josephguillaume/hydromad/blob/master/R/nseVarTd.R'><code>R/nseVarTd.R</code></a></small>
    <div class="hidden name"><code>nseVarTd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>adjVarTd coalesces modelled flow peaks to observed flow peaks for each event
separately. nseVarTd calculates Nash-Sutcliffe efficiency on the result
using <code><a href='nseStat.html'>nseStat</a></code>.  Depending on the quality of the coalescing,
this better indicate performance ignoring timing error.</p>
    </div>

    <pre class="usage"><span class='fu'>nseVarTd</span><span class='op'>(</span><span class='va'>obs</span>, <span class='va'>mod</span>, <span class='va'>event</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obs</th>
      <td><p>observed data vector</p></td>
    </tr>
    <tr>
      <th>mod</th>
      <td><p>model-predicted data vector corresponding to <code>obs</code>.</p></td>
    </tr>
    <tr>
      <th>event</th>
      <td><p>zoo object of events, as returned by <code><a href='events.html'>eventseq</a></code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to <code><a href='nseStat.html'>nseStat</a></code> and
<code><a href='estimateDelay.html'>estimateDelay</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For nseVarTd, a single numeric value.  For adjVarTd, a zoo object
with the original modelled and observed data, the adjusted model output and
the lag estimated for each event.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The success of this method in minimising the effect of timing error depends
on how well modelled and observed peaks can be coalesced. This depends on:</p><ul>
<li><p><code>event</code> - The separation into events - too short events
result in spurious cross-correlations, too long events may not adequately
capture the variability in lag. Other settings of <code><a href='events.html'>eventseq</a></code> may
also have an effect.</p></li>
<li><p><code>lag.max</code> - How long a lag is considered.
Too long may result in correlations between peaks, too short will fail to
consider the true peak. Instead of passing it as an argument, consider
setting max.delay using <code>link{hydromad.options}</code></p></li>
<li><p>Other settings
of <code><a href='estimateDelay.html'>estimateDelay</a></code> may also have an effect.</p></li>
<li><p>The function
currently considers both positive and negative lag up to <code>lag.max</code>.
This can not be overridden.</p></li>
</ul><p>Also note that large numbers of events will
run slower.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='hydromad.stats.html'>hydromad.stats</a></code>,<code><a href='nseStat.html'>nseStat</a></code>,<code><a href='objFunVal.html'>objFunVal</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Joseph Guillaume</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Murrindindi</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>Murrindindi</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>]</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>x</span>, X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/lag.html'>lag</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>Q</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>event</span> <span class='op'>&lt;-</span> <span class='fu'><a href='events.html'>eventseq</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>P</span>, thresh <span class='op'>=</span> <span class='fl'>5</span>, inthresh <span class='op'>=</span> <span class='fl'>3.5</span>, indur <span class='op'>=</span> <span class='fl'>7</span>, continue <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'><a href='nseStat.html'>nseStat</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>Q</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>X</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.2610415</div><div class='input'><span class='fu'>nseVarTd</span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>Q</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>X</span>, <span class='va'>event</span>, lag.max <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.03441884</div><div class='input'>
<span class='co'>## Avoiding passing lag.max</span>
<span class='fu'><a href='hydromad.options.html'>hydromad.getOption</a></span><span class='op'>(</span><span class='st'>"max.delay"</span><span class='op'>)</span> <span class='co'>## Current setting - default is 10</span>
</div><div class='output co'>#&gt; [1] 10</div><div class='input'><span class='fu'><a href='hydromad.options.html'>hydromad.options</a></span><span class='op'>(</span>max.delay <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>

<span class='fu'>nseVarTd</span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>Q</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>X</span>, <span class='va'>event</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.03441884</div><div class='input'><span class='fu'><a href='hydromad.stats.html'>hmadstat</a></span><span class='op'>(</span><span class='st'>"r.sq.vartd"</span><span class='op'>)</span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>Q</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>X</span>, event <span class='op'>=</span> <span class='va'>event</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.03441884</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joseph Guillaume.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


