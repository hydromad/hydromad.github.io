<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Analysis using Pareto-filtering of model performance across simulation
periods — paretoTimeAnalysis • hydromad</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis using Pareto-filtering of model performance across simulation
periods — paretoTimeAnalysis"><meta property="og:description" content="Identify dominated model realisations, that are inferior to another model in
all simulation periods, optionally in multiple catchments.  Summary results
are then produced to help assess how performance of model realisations and
model structures varies across simulation periods."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hydromad</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-27</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/hydromad.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Tutorial</a>
    </li>
    <li>
      <a href="../articles/hbv.html">HBV model</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Releases</li>
    <li>
      <a href="http://github.com/josephguillaume/hydromad" class="external-link">hydromad 0.9-27</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/josephguillaume/hydromad/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Analysis using Pareto-filtering of model performance across simulation
periods</h1>
    <small class="dont-index">Source: <a href="https://github.com/josephguillaume/hydromad/blob/HEAD/R/paretoTimeAnalysis.R" class="external-link"><code>R/paretoTimeAnalysis.R</code></a></small>
    <div class="hidden name"><code>paretoTimeAnalysis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Identify dominated model realisations, that are inferior to another model in
all simulation periods, optionally in multiple catchments.  Summary results
are then produced to help assess how performance of model realisations and
model structures varies across simulation periods.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">paretoTimeAnalysis</span><span class="op">(</span><span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for crossvalidation</span>
<span class="fu">paretoTimeAnalysis</span><span class="op">(</span>
  <span class="va">rl</span>,
  show.models <span class="op">=</span> <span class="cn">NA</span>,
  objectives <span class="op">=</span> <span class="st">"r.squared"</span>,
  qoi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>q90.in.units.of.runoff <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Q</span>, <span class="va">X</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">0.9</span>, na.rm <span class="op">=</span>
    <span class="cn">TRUE</span><span class="op">)</span>, r.sq.log <span class="op">=</span> <span class="fu"><a href="hydromad.stats.html">hmadstat</a></span><span class="op">(</span><span class="st">"r.sq.log"</span><span class="op">)</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>...</dt>
<dd><p>arguments to <code>paretoTimeAnalysis.crossvalidation</code> or
<code>paretoTimeAnalysis.data.frame</code></p></dd>
<dt>rl</dt>
<dd><p>a crossvalidation <code>runlist</code>: a list of fitted model objects
produced by <code><a href="crossValidate.html">crossValidate</a></code></p></dd>
<dt>show.models</dt>
<dd><p>If <code>TRUE</code>, print out a table of models and an
indication of whether they are dominated, as produced by
<code>paretoTimeAnalysis_areModelsDominated</code>. If not <code>NA</code>, write out
the table to "show.models_isdominated_models_catchments.csv")</p></dd>
<dt>objectives</dt>
<dd><p>Vector of column names containing performance measures
used to determine whether models are dominated across time periods. We
assume higher values are better. Values should be transformed prior to use.</p></dd>
<dt>qoi</dt>
<dd><p>Quantities of interest to calculate, as interpreted by
<code><a href="objFunVal.html">objFunVal</a></code>. Defaults are given as examples: 90th percentile
runoff (a scalar prediction) and R Squared using log transformed data (a
performance statistic).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>For <code>paretoTimeAnalysis</code>, no return value. Used for its side
effect of producing text. Optionally writes csv files (see the argument
<code>show.models</code>).
<code>paretoTimeAnalysis_areModelsDominated</code> produces a wide-format
data.frame with id variable columns, a column for each <code>sim.period</code>value, and a column <code>dominated</code> indicating whether another model is
better in all simulation periods.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Placeholder</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="crossValidate.html">crossValidate</a></code> for an example use of
<code>paretoTimeAnalysis.crossvalidation</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Joseph Guillaume</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Dataset consisting of results for two simulation periods,</span></span>
<span class="r-in"><span class="co">##  obtained by calibration in the same periods with different</span></span>
<span class="r-in"><span class="co">##  model structures.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">YeAl97</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## For one catchment, produce a table indicating whether models defined by</span></span>
<span class="r-in"><span class="co">## their calib.period and Model.str are dominated according to the objective E</span></span>
<span class="r-in"><span class="fu">paretoTimeAnalysis_areModelsDominated</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">YeAl97</span>, <span class="va">Catchment</span> <span class="op">==</span> <span class="st">"Salmon"</span><span class="op">)</span>, objectives <span class="op">=</span> <span class="st">"E"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Catchment calib.period Model.str objective First 5Y Second 5Y dominated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Salmon     First 5Y      GSFB         E     -Inf      -Inf      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    Salmon     First 5Y   IHACRES         E    0.865     0.774      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    Salmon     First 5Y    LASCAM         E    0.892     0.905     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    Salmon    Second 5Y      GSFB         E     -Inf      -Inf      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    Salmon    Second 5Y   IHACRES         E   -0.847     0.819      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Salmon    Second 5Y    LASCAM         E    0.795     0.930     FALSE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## For all catchments, performance analysis</span></span>
<span class="r-in"><span class="fu">paretoTimeAnalysis</span><span class="op">(</span><span class="va">YeAl97</span>, objectives <span class="op">=</span> <span class="st">"E"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cross-validation Pareto analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Which models cannot be rejected, due to dataset uncertainty/non-stationarity?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> == Eliminating Pareto-dominated models ==</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (worse than another model in all periods)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> How many models are dominated (and therefore eliminated)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Canning Salmon Stones</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FALSE       3      2      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TRUE        3      4      4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Which model structures are non-dominated in each catchment?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of model instances that are non-dominated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         GSFB IHACRES LASCAM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Canning    0     0.5      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Salmon     0     0.0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stones     0     0.0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Specify show.models=TRUE to show non-dominated and dominated models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Specify show.models=prefix to obtain csv of whether models are dominated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> == Performance across all periods ==</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> What is the range of non-dominated performance (RNDP) across all periods?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is it large - is changing datasets causing problems?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Catchment value.min value.max  RNDP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Canning     0.746     0.958 0.212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Salmon     0.795     0.930 0.135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Stones     0.824     0.886 0.062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> == Performance in each period ==</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> What is the RNDP in each period?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is it low even though total RNDP is high? Why?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Is there reason to believe the objective function is not comparable over time?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Catchment sim.period value.min value.max  RNDP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Canning   First 5Y     0.746     0.958 0.212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Canning  Second 5Y     0.824     0.945 0.121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Salmon   First 5Y     0.795     0.892 0.097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Salmon  Second 5Y     0.905     0.930 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Stones   First 5Y     0.824     0.886 0.062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Stones  Second 5Y     0.869     0.883 0.014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> == Worst non-dominated models in each period ==</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Do any non-dominated models have unacceptable performance?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Which non-dominated model has the worst performance in each period? Why?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Is it consistently the same dataset? Is there reason for that dataset to be problematic?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Is it consistently the same model structure? Should another model structure have been selected?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Is it consistently the same calibration objective function? Is it overfitting part of the record?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Canning </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sim.period worst.performance calib.period Model.str First.5Y Second.5Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    First 5Y             0.746    Second 5Y    LASCAM    0.746     0.945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Second 5Y             0.824     First 5Y    LASCAM    0.958     0.824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Salmon </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sim.period worst.performance calib.period Model.str First.5Y Second.5Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    First 5Y             0.795    Second 5Y    LASCAM    0.795     0.930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Second 5Y             0.905     First 5Y    LASCAM    0.892     0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Stones </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sim.period worst.performance calib.period Model.str First.5Y Second.5Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    First 5Y             0.824    Second 5Y    LASCAM    0.824     0.883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Second 5Y             0.869     First 5Y    LASCAM    0.886     0.869</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> == Variation in inferred internal behaviour - Range of non-dominated parameters ==</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is the range of parameters of non-dominated models large for any single model structure?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Does the difference in performance correspond to different internal model behaviour?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> argument 'pars' missing, skipping section</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joseph Guillaume.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

